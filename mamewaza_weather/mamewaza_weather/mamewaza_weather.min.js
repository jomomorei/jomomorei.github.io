/**
Copyright 2015 Bsharp Inc. http://bsharp.jp/
Licensed under GPL.
Download, Support: http://mamewaza.com/tools/
*/

!function(a){a.mamewaza_weather=function(e){var t={"晴れ":1,"晴時々曇":2,"晴時々雨":3,"晴時々雪":4,"晴のち曇":5,"晴のち雨":6,"晴のち雪":7,"曇り":8,"曇時々晴":9,"曇時々雨":10,"曇時々雪":11,"曇のち晴":12,"曇のち雨":13,"曇のち雪":14,"雨":15,"雨時々晴":16,"雨時々曇":17,"雨時々雪":18,"雨のち晴":19,"雨のち曇":20,"雨のち雪":21,"暴風雨":22,"雪":23,"雪時々晴":24,"雪時々曇":25,"雪時々雨":26,"雪のち晴":27,"雪のち曇":28,"雪のち雨":29,"暴風雪":30};if(!((e=a.extend({},{selector:"#weather",region:1,layout:"vertical",when:"7days",explanation:!1,cssPath:"./mamewaza_weather/mamewaza_weather.css"},e)).selector&&a(e.selector)[0]&&e.region&&e.region.toString().match(/^\d{6}$/)))return"";var s=function(s){if(!s||!s.channel||!s.channel.item)return"";var l=-1!=e.layout.indexOf("horizontal"),n=-1!=e.layout.indexOf("Mini"),r=-1!=e.layout.indexOf("Micro"),c=!n&&!r,o='<div><table class="mamewaza_weather">';if("vertical"==e.layout&&(o+='<tr><th>日付</th><th>天気</th><th>最高<span class="mamewaza_weather_small">℃</span></th><th>最低<span class="mamewaza_weather_small">℃</span></th></tr>'),l)if(c)var m={col1:"<th>日付</th>",col2:"<th>天気</th>",col3:'<th>最高<span class="mamewaza_weather_small">℃</span></th>',col4:'<th>最低<span class="mamewaza_weather_small">℃</span></th>'};else m={col1:"",col2:"",col3:"",col4:""};for(var h=s.channel.item,i=0,p=0;i<h.length;i++)if("PR"!=h[i].category){if("1day"==e.when&&1==p||"2days"==e.when&&2==p)break;if(h[i].description&&h[i].description.match(/(\d{2})日（(月|火|水|木|金|土|日)）の天気は([^、]+)、最高気温は([\d\.-]*)℃ (?:最低気温は([\d\.-]*)℃)?でしょう。/)){var d=parseInt(RegExp.$1,10).toString(),w=RegExp.$2,_=RegExp.$3,g=RegExp.$4,z=RegExp.$5,f="&#xe"+(800+t[_]).toString()+";";if("weekend"!=e.when||"土"==w||"日"==w){var u=n?d+'<span class="mamewaza_weather_small">'+w+"</span>":d+'<span class="mamewaza_weather_small">日('+w+")</span>",y=r?z+"～"+g+'<span class="mamewaza_weather_small">℃</span>':n?'<span class="mamewaza_weather_small">'+_+"</span>":_,v="土"==w?' class="mamewaza_weather_sat"':"日"==w?' class="mamewaza_weather_sun"':"";l?(m.col1+="<td"+v+">"+u+"</td>",m.col2+='<td><span class="mamewaza_weather_icon">'+f+"</span><br />"+y+"</td>",n?m.col3+="<td>"+z+" ～ "+g+'<span class="mamewaza_weather_small">℃</span></td>':c&&(m.col3+="<td>"+g+"</td>",m.col4+="<td>"+z+"</td>")):(o+="<tr><td"+v+">"+u+"</td><td"+(n?v:"")+'><span class="mamewaza_weather_icon">'+f+"</span><br />"+y+"</td>",o+=r?"":n?"<td"+v+">"+z+" ～ "+g+'<span class="mamewaza_weather_small">℃</span></td>':"<td>"+g+"</td><td>"+z+"</td>",o+="</tr>"),p++}}}l&&(o+="<tr>"+m.col1+"</tr><tr>"+m.col2+"</tr>"+(m.col3?"<tr>"+m.col3+"</tr>":"")+(m.col4?"<tr>"+m.col4+"</tr>":"")),o+='</table><div class="mamewaza_weather_exp" style="display:block !important;visibility:visible !important;position:static !important;">'+(e.explanation?s.channel.description.replace(/[\r?\n]{2}/g,"<br />"):"")+'<a href="'+s.channel.link+'" target="_blank">'+s.channel.title+'</a><span class="memewaza_asscembled">assembled by <a href="http://mamewaza.com/" target="_blank" rel="nofollow">まめわざ</a></span></div></div>',a(e.selector).append(o)};!function(){document.createStyleSheet?document.createStyleSheet(e.cssPath):a("head").append('<link href="'+e.cssPath+'" rel="stylesheet" type="text/css" />');var t=new Date,l=t.getFullYear().toString()+(t.getMonth()<9?"0":"")+(t.getMonth()+1).toString()+(t.getDate()<10?"0":"")+t.getDate().toString()+Math.floor(t.getHours()/6).toString();a.ajax({timeout:5e3,url:"https://mamewaza.net/w/",dataType:"jsonp",cache:!0,data:{area:e.region,date:l},success:s,error:function(a,e){}})}()}}(jQuery);